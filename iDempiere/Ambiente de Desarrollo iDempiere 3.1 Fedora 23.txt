Leer Previamente (algunas cosas pueden cambiar)
-----------------------------------------------
http://wiki.idempiere.org/en/Install_Development_Prerequisites
http://wiki.idempiere.org/en/Importing_DB_Seed_Manually
http://wiki.idempiere.org/en/Update_your_development_environment_zk7_branch
http://wiki.idempiere.org/en/Setting_up_Eclipse


Instalar utilidades
-------------------
# dnf update -y
# dnf install -y ant svn maven mercurial dos2unix


Configuración postgresql
------------------------
# dnf install -y postgresql-server postgresql-devel postgresql-contrib pgadmin3
# postgresql-setup --initdb
# systemctl enable postgresql.service
# systemctl start postgresql.service
# su - postgres
$ psql
postgres=# ALTER USER postgres WITH password 'postgres';
postgres=# \q
$ exit
# cd /var/lib/pgsql/data/
# nano postgresql.conf
Cambiar listen_addresses a listen_addresses = '*'
Descomentar port = 5432
# nano pg_hba.conf
Cambiar métodos de autenticación a md5
# systemctl restart postgresql.service


Clonar proyecto
---------------
$ mkdir -p ~/Workspace && cd ~/Workspace
$ hg clone ssh://hg@bitbucket.org/idempiere/idempiere -r release-3.1 idempiere31


Variables de entorno
--------------------
$ nano ~/.bashrc
Agregar al final:
export IDEMPIERE31_REPOSITORY="$HOME/Workspace/idempiere31"
$ source ~/.bashrc
$ echo $IDEMPIERE31_REPOSITORY


Instalar IDE
------------
- Instalar Eclipse Luna
- Instalar Mecurial en Eclipse Luna desde: Help > Eclipse Marketplace 
- Instalar buckmister en Eclipse Luna desde: Help > Install New Software > Add
- Ingresar http://download.eclipse.org/tools/buckminster/updates-4.4
- Instalar Buckminster Core, Buckminster Maven Support, Buckminster PDE Support
- Crear la carpeta targetPlatform en el directorio de idempiere
- Ir a la opción Windows > Preferences > Plug-in Development > Target Platform > Add
- En la pantalla emergente tildamos la primera opción: Nothing: Start... y hacemos clic al botón Next
- En la siguiente pantalla colocamos en el campo Name: iDempiere Target Platform
- Luego en la pestaña Locations hacemos clic al botón Add
- Seleccionamos la opción Directory y luego hacemos clic en Next
- Ingresamos la ruta $IDEMPIERE31_REPOSITORY/targetPlatform y hacemos click en Finish y Finish
- Luego en la pestaña Environment colocamos las siguientes opciones (estar pendiente con la arquitectura):
Operating System: linux
Windowing System: gtk
Architecture: x86_64
- En Java Runtime Environmet seleccionamos Default JRE y hacemos clic en Finish
- En la ventana Preferences eliminamos los otros target y seleccionamos el nuevo target y presionamos Apply y luego OK


Materialización del proyecto
----------------------------
- Ir a la opción File > Import...
- Seleccionamos Buckminster > Materialize... y hacemos clic en el botón Next
- Seleccionar el archivo adempiere.cquery en la carpeta $IDEMPIERE31_REPOSITORY/org.adempiere.sdk-feature y presionamos Ok
- Aparecerá una pantalla donde se indica el progreso de importación del proyecto
- Al finalizar el proceso de importación del proyecto hacemos clic en el botón Finish


Creación de base de datos semilla
---------------------------------
$ psql -U postgres -c "CREATE ROLE adempiere SUPERUSER LOGIN PASSWORD 'adempiere'"
$ createdb  --template=template0 -E UNICODE -O adempiere -U adempiere idempiere31_seed
$ psql -d idempiere31_seed -U adempiere -c "ALTER ROLE adempiere SET search_path TO adempiere, pg_catalog"
$ psql -d idempiere31_seed -U adempiere -c 'CREATE EXTENSION "uuid-ossp"'
$ cd /tmp
$ jar xvf "$IDEMPIERE31_REPOSITORY/org.adempiere.server-feature/data/seed/Adempiere_pg.jar"
$ psql -d idempiere31_seed -U adempiere -f Adempiere_pg.dmp


Migración de semilla
--------------------
Usar el archivo syncApplied.sh de la carpeta Recursos
$ chmod +x syncApplied.sh
$ ./syncApplied.sh idempiere31_seed "$IDEMPIERE31_REPOSITORY/migration"


Creación de base de datos desarrollo
------------------------------------
$ createdb  --template=idempiere31_seed -E UNICODE -O adempiere -U adempiere idempiere31_dev


Correr proyecto
---------------
- Luego que el proyecto se encuentre materializado sin problemas
- Run > Run Configurations
- Ejecutar Eclipse Aplication > install.app
- En Servidor Aplicación: 0.0.0.0
- Nombre Base de Datos: idempiere31_dev
- Luego ejecutar Eclipse Aplication > server.product


Errores posibles
----------------
Si al ejecutar iDempiere ocurre "Too many open files" 
es por configuración del jetty. Solución:

# nano /etc/security/limits.conf
Agregar al final:
*         hard    nofile      500000
*         soft    nofile      500000
root      hard    nofile      500000
root      soft    nofile      500000
